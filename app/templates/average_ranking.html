{% extends "base.html" %}

{% block title %}全体ランキング{% endblock %}

{% block content %}
    <h1 style="text-align: center;">テスト別 全体ランキング</h1>

    {% for ranking in rankings_by_test %}
        <div class="ranking-container">
            <h2 style="text-align: center;">{{ ranking.test_name }}</h2>
            <table>
                <thead>
                    <tr>
                        <th>順位</th>
                        <th>生徒名</th>
                        <th>平均点</th>
                        <th>受験回数</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in ranking.records %}
                    <tr>
                        <td>{{ loop.index }}位</td>
                        <td>{{ record.student_name }}</td>
                        <td>{{ "%.1f"|format(record.average_score) }}点</td>
                        <td>{{ record.test_count }}回</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <div style="text-align: center; margin-top: 10px; margin-bottom: 30px;">
                <a href="{{ url_for('print_average_ranking', test_id=ranking.test_id) }}" target="_blank" class="button">印刷</a>
            </div>
        </div>
    {% else %}
        <p style="text-align: center;">表示できる成績データがありません。</p>
    {% endfor %}
{% endblock %}